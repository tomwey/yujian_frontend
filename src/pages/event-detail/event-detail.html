<!--
  Generated template for the EventDetail page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header no-border>

  <ion-navbar>
    <ion-title>活动详情</ion-title>
  </ion-navbar>

</ion-header>

<ion-content class="event-content">
  <!-- 活动信息 -->
  <ion-card>
    <ion-list>
      <ion-item>
        <h2 text-wrap>{{event.title}}</h2>
        <p class="stats">
          <span class="data">人气 {{event.view_count}}, <!--转发 {{event.share_count}}, -->点赞 {{event.likes_count}}</span>
          <button ion-button icon-left clear small class="like-btn" (click)="doLike()">
            <ion-icon name="ios-thumbs-up-outline"></ion-icon> 赞一下
          </button>
        </p>
      </ion-item>
    </ion-list>
    <ion-card-content>
      <div class="event-body" [innerHTML]="event.body"></div>
    </ion-card-content>
    <ion-item>
      <p text-wrap>如果发现内容不实，欢迎举报！</p>
      <button ion-button icon-left clear small item-right style="color: black;" (click)="gotoReport()">
          <ion-icon name="ios-warning-outline"></ion-icon> 举报
      </button>
    </ion-item>
  </ion-card>
  <!-- 活动规则 -->
  <ion-card *ngIf="event.rule">
    <ion-card-header>
      {{event.rule.name}}
    </ion-card-header>
    <ion-card-content>
      <div class="rule-box quiz" *ngIf="event.rule_type === 'QuizRule'">
        <div class="tip" style="color: red;">题目的答案在上面的活动内容里面找</div>
        <div class="content">
          <ion-list radio-group [(ngModel)]="answer">
            <ion-list-header>
              <h2 class="question" text-wrap>{{event.rule.question}}</h2>
            </ion-list-header>
            <ion-item *ngFor="let answer of event.rule.answers">
              <ion-label class="answer-label" text-wrap>{{answer}}</ion-label>
              <ion-radio value="{{answer}}"></ion-radio>
            </ion-item>
          </ion-list>
        </div>
      </div>
      <div class="rule-box checkin" [hidden]="event.rule_type !== 'CheckinRule'">
        <div class="tip">请到如下地址完成签到，可以获得红包！<span style="color: red;">(位置误差不超过{{event.rule.accuracy}}米)</span></div>
        <div class="content"><ion-icon name="ios-pin-outline"></ion-icon> {{event.rule.address}}</div>
      </div>
      <button ion-button block color="theme-red" (click)="commit()" [disabled]="disableCommit">{{commitButtonText}}</button>
    </ion-card-content>
  </ion-card>
  <!-- 活动结果 -->
  <ion-card [hidden]="earns.length == 0">
    <ion-card-header>
      共 {{event.hb.sent_money}} / {{event.hb.total_money}} 元
    </ion-card-header>

    <ion-list>
      <ion-item *ngFor="let earn of earns">
        <ion-avatar item-left>
          <img [src]="earn.user.avatar" />
        </ion-avatar>
        <h2>{{earn.user.nickname}}</h2>
        <p>{{earn.time}}</p>
        <ion-note item-right>
          {{earn.money}} 元
        </ion-note>
      </ion-item>
    </ion-list>

    <div class="load-more" [hidden]="!hasMore">
      <ion-infinite-scroll (ionInfinite)="doInfinite($event)" [enabled]="hasMore">
        <ion-infinite-scroll-content
          loadingSpinner="bubbles"
          loadingText="正在加载...">
        </ion-infinite-scroll-content>
      </ion-infinite-scroll>
    </div>

  </ion-card>
  
</ion-content>
